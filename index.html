<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>EMEX - Pesquisa de Satisfacao</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
    :root {
        --bg: #0e2a47;
        --card: #0f3356;
        --card-2: #123c67;
        --text: #f4f6fb;
        --muted: #c7d3e6;
        --accent: #ff9f1c;
        --accent-2: #56cfe1;
        --shadow: 0 18px 60px rgba(0, 0, 0, 0.35);
    }

    * { box-sizing: border-box; }

    body {
        font-family: "Poppins", "Segoe UI", Arial, sans-serif;
        padding: 0;
        margin: 0;
        background: radial-gradient(circle at 20% 20%, rgba(255, 159, 28, 0.12), transparent 25%), radial-gradient(circle at 80% 0%, rgba(86, 207, 225, 0.22), transparent 30%), var(--bg);
        color: var(--text);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: flex-start;
        padding: 32px 16px 48px;
    }

    .shell {
        width: 100%;
        max-width: 720px;
    }

    .card {
        background: linear-gradient(135deg, var(--card), var(--card-2));
        border-radius: 18px;
        padding: 28px 24px;
        box-shadow: var(--shadow);
        backdrop-filter: blur(4px);
    }

    .logo {
        display: block;
        margin: 0 auto 12px;
        width: min(180px, 60vw);
        max-height: 64px;
        object-fit: contain;
        filter: drop-shadow(0 6px 18px rgba(0, 0, 0, 0.35));
    }

    .tag {
        display: inline-flex;
        gap: 8px;
        align-items: center;
        padding: 6px 12px;
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.08);
        color: var(--muted);
        font-size: 13px;
        margin: 8px auto 16px;
    }

    h1 {
        margin: 10px 0 6px;
        font-size: 26px;
        font-weight: 700;
        letter-spacing: 0.2px;
        text-align: center;
    }

    h2 {
        font-size: 20px;
        font-weight: 600;
        margin: 12px 0 8px;
        text-align: center;
    }

    p {
        margin: 0 0 12px;
        color: var(--muted);
        font-size: 16px;
        line-height: 1.5;
        text-align: center;
    }

    .nps-scale {
        margin: 22px 0 14px;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(56px, 1fr));
        gap: 12px;
    }

    .score-btn {
        border: none;
        border-radius: 14px;
        padding: 14px 0;
        font-size: 17px;
        font-weight: 700;
        color: #fff;
        cursor: pointer;
        transition: transform 0.12s ease, box-shadow 0.12s ease, opacity 0.12s ease;
        box-shadow: 0 12px 28px rgba(0, 0, 0, 0.28);
    }

    .score-btn:hover { transform: translateY(-2px) scale(1.01); opacity: 0.94; }
    .score-btn.selected { outline: 2px solid rgba(255, 255, 255, 0.92); box-shadow: 0 14px 32px rgba(0, 0, 0, 0.38); transform: translateY(-2px) scale(1.02); }

    .legend {
        display: flex;
        justify-content: space-between;
        align-items: center;
        color: var(--muted);
        font-size: 14px;
        margin: 4px 2px 18px;
    }

    .textarea {
        width: 100%;
        min-height: 120px;
        border-radius: 14px;
        border: 1px solid rgba(255, 255, 255, 0.08);
        background: rgba(255, 255, 255, 0.06);
        color: var(--text);
        padding: 12px 14px;
        font-size: 15px;
        resize: vertical;
        box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.04);
    }

    .actions {
        margin-top: 16px;
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
        justify-content: center;
    }

    .btn {
        padding: 12px 18px;
        border-radius: 12px;
        border: none;
        color: #0b223a;
        font-weight: 700;
        cursor: pointer;
        transition: transform 0.12s ease, box-shadow 0.12s ease;
    }

    .btn-primary {
        background: linear-gradient(135deg, var(--accent), #ff6b35);
        box-shadow: 0 12px 26px rgba(255, 111, 53, 0.35);
    }

    .btn-secondary {
        background: linear-gradient(135deg, var(--accent-2), #4ea8de);
        color: #05233b;
        box-shadow: 0 12px 26px rgba(78, 168, 222, 0.28);
    }

    .btn:hover { transform: translateY(-2px); }

    .thank-you {
        margin-top: 22px;
        text-align: center;
        padding: 16px 14px;
        border-radius: 14px;
        background: rgba(255, 255, 255, 0.06);
        border: 1px solid rgba(255, 255, 255, 0.08);
        display: none;
    }

    .gif {
        width: 100%;
        max-width: 520px;
        margin: 14px auto 6px;
        border-radius: 16px;
        display: block;
        box-shadow: 0 12px 32px rgba(0, 0, 0, 0.35);
    }

    .footer {
        text-align: center;
        margin-top: 18px;
        font-size: 13px;
        color: var(--muted);
    }

    .google-tip {
        margin-top: 10px;
        font-size: 13px;
        color: var(--muted);
    }

    @media (max-width: 520px) {
        body { padding: 22px 12px 36px; }
        .card { padding: 22px 18px; }
        h1 { font-size: 23px; }
        h2 { font-size: 18px; }
        .actions { flex-direction: column; }
        .actions .btn { width: 100%; }
    }
</style>
</head>

<body>

<div class="shell">
    <div class="card">
        <img class="logo" src="LogoEmex.png" alt="EMEX LOGO">
        <div class="tag">Pesquisa de satisfacao - NPS</div>

        <h1>Queremos ouvir voce, <span id="clienteNome">Cliente</span>!</h1>
        <p>Conte para a <b>EMEX</b> como foi sua experiencia. Sua opiniao direciona nossas melhorias.</p>

        <h2>De 0 a 10, qual a probabilidade de indicar a EMEX?</h2>
        <div class="nps-scale" id="npsScale"></div>
        <div class="legend">
            <span>Pouco provavel</span>
            <span>Muito provavel</span>
        </div>

        <h2>Explique sua nota</h2>
        <textarea class="textarea" id="comentario" placeholder="Digite sua resposta..."></textarea>

        <div class="actions">
            <button class="btn btn-primary" id="enviar">Enviar</button>
        </div>

        <div class="thank-you" id="thankYou">
            <p id="mensagemFinal">Obrigado! Seu feedback e muito importante para nos.</p>
            <img class="gif" src="https://media.giphy.com/media/l0MYt5jPR6QX5pnqM/giphy.gif" alt="Gif de agradecimento">
        </div>
    </div>

    <div class="footer">
        Desenvolvido por <b>Joao Porto</b>
    </div>
</div>

<script>
    const googleReviewLink = "https://g.page/r/CbtxDmKG0tleEAE/review";
    const whatsappNumber = "558000243200";
    const whatsappMessage = encodeURIComponent("Pesquisa de Satisfacao");

    // Se quiser registrar no Google Forms, coloque o formResponse e os IDs dos campos
    const googleFormsAction = ""; // ex: "https://docs.google.com/forms/d/e/FORM_ID/formResponse"
    const googleFormsFields = {
        name: "",    // ex: "entry.123456"
        score: "",   // ex: "entry.789012"
        comment: ""  // ex: "entry.345678"
    };

    const urlParams = new URLSearchParams(window.location.search);
    const nome = urlParams.get("nome") || "Cliente";
    document.getElementById("clienteNome").textContent = nome;

    // Monta botoes NPS com cores de 0 a 10
    const npsScale = document.getElementById("npsScale");
    const colors = ["#b90f23", "#c21b1f", "#d12f1c", "#e1491c", "#f26b21", "#f9a22b", "#d6c522", "#c8dd2b", "#98c93d", "#70bb43", "#42a34b"];
    let selectedScore = null;

    colors.forEach((color, index) => {
        const btn = document.createElement("button");
        btn.className = "score-btn";
        btn.style.background = color;
        btn.textContent = index;
        btn.setAttribute("aria-label", `Nota ${index}`);
        btn.addEventListener("click", () => {
            selectedScore = index;
            document.querySelectorAll(".score-btn").forEach(b => b.classList.remove("selected"));
            btn.classList.add("selected");
            comentario.scrollIntoView({ behavior: "smooth", block: "start" });
            comentario.focus({ preventScroll: true });
        });
        npsScale.appendChild(btn);
    });

    const thankYou = document.getElementById("thankYou");
    const mensagemFinal = document.getElementById("mensagemFinal");
    const comentario = document.getElementById("comentario");

    const submitToGoogleForms = async ({ name, score, comment }) => {
        if (!googleFormsAction || !googleFormsFields.name || !googleFormsFields.score || !googleFormsFields.comment) {
            return;
        }
        const data = new FormData();
        data.append(googleFormsFields.name, name);
        data.append(googleFormsFields.score, score);
        data.append(googleFormsFields.comment, comment);
        try {
            await fetch(googleFormsAction, { method: "POST", mode: "no-cors", body: data });
        } catch (err) {
            console.error("Falha ao enviar para Google Forms", err);
        }
    };

    const openWhatsApp = () => {
        const waLink = `https://wa.me/${whatsappNumber}?text=${whatsappMessage}`;
        window.location.href = waLink;
    };

    const openGoogleReview = () => {
        window.location.href = googleReviewLink;
    };

    document.getElementById("enviar").addEventListener("click", async () => {
        if (selectedScore === null) {
            alert("Escolha uma nota de 0 a 10.");
            return;
        }

        const texto = comentario.value.trim();
        thankYou.style.display = "block";

        await submitToGoogleForms({ name: nome, score: selectedScore, comment: texto });

        if (selectedScore <= 6) {
            mensagemFinal.innerHTML = `${nome}, sentimos muito! :( Vamos te atender no WhatsApp para resolver.`;
            setTimeout(openWhatsApp, 400);
            return;
        }

        if (selectedScore === 10) {
            mensagemFinal.innerHTML = `${nome}, obrigado! :) Voce sera redirecionado para avaliar no Google.`;
            setTimeout(openGoogleReview, 400);
            return;
        }

        mensagemFinal.innerHTML = `${nome}, obrigado! :) Sua nota <b>${selectedScore}</b> foi registrada.`;
    });
</script>

</body>
</html>
